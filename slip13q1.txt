import pandas as pd
import numpy as np
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

# Load dataset
df = pd.read_csv("Google_Stock_Price.csv")
prices = df["Close"].values.reshape(-1, 1)

# Normalize data
scaler = MinMaxScaler()
scaled = scaler.fit_transform(prices)

# Prepare data (using last 60 days to predict next day)
X, y = [], []
for i in range(60, len(scaled)):
    X.append(scaled[i-60:i])
    y.append(scaled[i])

X = np.array(X)
y = np.array(y)

# Build RNN model
model = Sequential()
model.add(LSTM(50, return_sequences=True, input_shape=(60, 1)))
model.add(LSTM(50))
model.add(Dense(1))

model.compile(optimizer="adam", loss="mse")
model.fit(X, y, epochs=10, batch_size=32)

# Predict the next day
last_60 = scaled[-60:].reshape(1, 60, 1)
next_day_price = model.predict(last_60)
next_day_price = scaler.inverse_transform(next_day_price)

print("Predicted next day price:", next_day_price[0][0])

# Trend: Increase or Decrease?
today = prices[-1][0]
predicted = next_day_price[0][0]

if predicted > today:
    print("Trend: ðŸ”¼ Price will INCREASE tomorrow")
else:
    print("Trend: ðŸ”½ Price will DECREASE tomorrow")
